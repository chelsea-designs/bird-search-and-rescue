# Test Cases and Execution Report

To navigate back to the main README click [here](README.md)

## Validators

### Python Validation
The Python code was checked using the flake8 python linter using the command python3 -m flake8. No errors were reported by the validator in the files I created. The settings.py file did however did contain an error for env being imported but unused, which is a false positive. Similarly, another error in checkout/apps.py however 'checkout.signals' is being passed in and used elsewhere, so is not an issue.

* Screenshots of the validator report is [here](static/docs/img/validators/python-validation.png) 


### JavaScript Validation
The JavaScript code was checked using the jshint.com validator available at [jshint.com](https://jshint.com/). No errors were detected within the files I created. 

* Screenshot of the validator report is available here:
    * JavaScript
        * [htmx.js file](/static/docs/img/validation/htmx-validator-results.png)
        * [quantity_input file](/static/docs/img/validation/quantity-input-script.png)
        * [script.js file](/static/docs/img/validation/script-validator-results.png)
        * [stripe.js file](/static/docs/img/validation/stripe-js-validator-results.png)
        * [summernote.js file](/static/docs/img/validation/summernote-js-results.png)


### CSS Validation

The full CSS Validator report is available here on the [CSS Validator Site](https://jigsaw.w3.org/css-validator/validator?uri=https%3A%2F%2Fdruid-computers.herokuapp.com%2F&profile=css3svg&usermedium=all&warning=1&vextwarning=&lang=en) . When validating by url it discovers a total of 301 warnings relating to the Mailchimp newsletter imported css and the bootstrap code. The validator reports three warnings for the main style.css file, the warnings only relate to the use of css variables which the validator does not check and can be ignored. When validating by direct input the validator also reports a warning about the imported style sheet - or the google font import, the warning only states that it does not check the imported style sheet in direct input mode and can be ignored.

* [CSS Validator Report - style.css](/static/docs/img/validation/css-validator-results.png)
* [Checkout CSS file results](/static/docs/img/validation/checkout-css-validator-results.png)
* [Summernote CSS file results](/static/docs/img/validation/summernote-css-validator-results.png)


### HTML Validation
Due to the way Django templates include Django template code in them, and extend other templates, it is not possible to copy the code for each page out of the source html files. Therefore, in order to validate the code correctly, I navigated to the site and accessed the rendered html code through the developer tools of the browser I used during development, Google Chrome. I then pasted the code into the HTML validator site available at [W3C Markup Validation Service](https://validator.w3.org/). When validating the pages accessible by url - those that do not require a login - the validator returns three warnings relating to the type attribute being unnecessary for javascript resources. All of these warnings are generated by imported files, mailchimp, bootstrap and fontawesome, as the script declaration is not within the html code but in resources being inserted via the cdn links these warnings can not be removed and are therefore ignored. There were no errors returned from the HTML produced from the templates themselves. When copying and pasting the code from the brower into the direct input option within the validator, it shows a total of 10 errors. Six (6) errors are produced by the code inserted from fontawesome and relate to CSS code it inserts for animations, whilst the remaining four (4) errors are created by the Stripe JS file and relate to the use of a name attribute and CSS styling on an iframe that it inserts. These errors and warnings can not be removed as they are inserted by the Fontawesome and Stripe cdn files. They do not interfere with the functionality of the site and have therefore been ignored.

Pages with a Summernote text editor will return six (6) HTML validation errors. These errors are generated by the iframe code the summernote editor inserts. One appears to be related to the summernote code having a hidden text area input - whilst the others are related to styling rules that are being applied to the summernote editor field. As they are inserted by the summernote editor they have been ignored.

A full list of the errors and warnings that are generated by the cdn links or third party packages can be seen [here](/static/docs/img/validation/full-list-of-html-validator-errors-warnings.png).

Given that there is logic utilised within the templates to display some elements under different conditions,  test cases were developed to cover the different variations of logic available within the sites pages. Each is detailed in the full testing file available from the link at the top of this page, or in the screenshots at the top of this section.

* [Bag page - empty bag](/static/docs/img/validation/bag-empty.png)
* [Bag page - products in bag](/static/docs/img/validation/bag-with-products-fixed.png)
* [Blog - add blog page](/static/docs/img/validation/blog-add-blog-post.png)
* [Blog - all posts page](/static/docs/img/validation/blog-all-posts-page.png)
* [Blog - all posts with categories page](/static/docs/img/validation/blog-all-posts-with-category-form.png)
* [Blog - Blog Post Detail page](/static/docs/img/validation/blog-blog-post-detail.png)
* [Blog - Multiple category forms opens](/static/docs/img/validation/blog-category-forms-all-open-at-same-time.png) this shows the validation errors that were fixed using javascript - details in the notable bugs section of the main README file.
* [Blog - Edit blog post](/static/docs/img/validation/blog-edit-blog-post.png)
* [Checkout - checkout success](/static/docs/img/validation/checkout-checkout-success.png)
* [Checkout - My Orders page](/static/docs/img/validation/checkout-my-orders-logged-in.png)
* [Checkout - Order Management Page](/static/docs/img/validation/checkout-order-management-page.png)
* [Checkout - Order Status non logged in user](/static/docs/img/validation/checkout-order-status-non-logged-in.png)
* [Checkout - Update Order Status - employee view](/static/docs/img/validation/checkout-update-order-status.png)
* [Home - Home page](/static/docs/img/validation/home-home.png)
* [Home - About page](/static/docs/img/validation/home-about.png)
* [Home - Contact page](/static/docs/img/validation/home-contact.png)
* [Privacy Policy Page](/static/docs/img/validation/privacy-policy-page.png)
* [Products - add products page](/static/docs/img/validation/products-add-product.png)
* [Products - all products page](/static/docs/img/validation/products-all-products.png)
* [Products - edit product page](/static/docs/img/validation/products-edit-product.png)
* [Products - product management page](/static/docs/img/validation/products-management.png)
* [Products - product details page](/static/docs/img/validation/products-product-detail-page.png)
* [Products - product details page with a review](/static/docs/img/validation/products-product-detail-page-with-review.png)
* [Products - product details page with a review and response](/static/docs/img/validation/products-product-detail-page-with-review-and-response.png)
* [Products - product details page with review form](/static/docs/img/validation/products-product-detail-review-form-showing.png)
* [Products - product details page with a review and response form showing](/static/docs/img/validation/products-product-detail-with-response-form-showing.png)
* [Products - Search Results page](/static/docs/img/validation/products-search-results.png)
* [Profiles - Delete Address](/static/docs/img/validation/profile-delete-address.png)
* [Profiles - Edit Address](/static/docs/img/validation/profile-edit-address.png)
* [Profiles - edit details](/static/docs/img/validation/profile-edit-details.png)
* [Profiles - wishlist page](/static/docs/img/validation/profile-wishlist-page.png)

#### Validator Testing
All code files were validated using suitable validators for the specific language. The full details can be found in the testing.md file.
All code passed the validation, with only code generated by other parties producing errors or warnings.
* Django built in code within the settings file produced five line length errors. 
* Bootstrap code produced 260 warnings in the CSS validation. 
* Fontawesome cdn produced 6 HTML validation errors relating to css variables within the cdn css code. 
* The HTMX library that is inserted into the HTML template by django produces a warning stating that the link does not need to have the javascript file type declared.


#### Lighthouse Testing
Google's lighthouse testing was utilised to gain an overall assessment of the performance of the site. Whilst all the areas of the test return a green score above 98, the overall performance figure fluctuates depending on the speed of the internet connection when the test is performed, having returned scores as low as 92 and as high as 100 whilst running the test multiple times. The best practice score is impacted by the stripe included javascript files along with the use of the bootstrap and jquery libraries. The SEO score returned a perfect 100.

![Google Lighthouse Results](/static/docs/img/lighthouse.png)



#### Notable Bugs

* Whilst validating the HTML it reported an error that I had included a placeholder for a checkbox field which is not allowed. To fix this error I removed the placeholder from the list within the forms.py file for the relevant address form. Thinking that will sort the error out and its only a placeholder so doesn't affect anything else. It did fix the HTML validation error straight away, however, it created a bug within another part of the code where the fields were checked whether they were required or not. If a field was required it adds '*' to signify it to users, if it is not, it inserts the placeholder. However, now I had removed the placeholder, anytime the form was requested it would return a 500 error. Whilst I appreciated the ability to test the custom 500 error page worked correctly on the production site it was a bug that took me a little while to track down the route cause and fix. The fix was simple enough and achieved by including the default field of the model within the if statement and excluding it from the placeholder assignment.

* Within the News post page employee view, there is a category management section that can be activated. This section allows an employee to edit, delete and create categories for News posts. Forms are inserted via htmx into the html on demand to allow the employee to carry out the task required. As the forms are inserted via htmx, it was possible to insert multiple forms at the same time into the page and edit multiple categories at once, and have the add category form open as well. If the user did this, a HTML validation error would occur as the form is duplicated it contains duplicate ID's. To overcome the HTML validation error possibility, JavaScript was utilised to prevent the user from opening multiple forms at the same time, this was achieved by disabling the other buttons when a user clicks on one of the edit buttons or add buttons, until either the user cancels their action or has completed their task.

* Order Status updates. Within the order management section of the site, employees have the ability to update the status of an order. To help with finding the correct order, multiple filters are available for them to search the orders within the database. One of these filters allows for searching the previous days orders. This works as designed during normal working hours, however when testing the functionality it was discovered that during the first hour of the day, so the time period between midnight and 1am the filter would bring back the previous day plus one's orders, not the previous days. This resolves itself as soon as the time clicks past 1am. As the only time that this will be triggered is in the middle of the night, it was deemed acceptable to leave as it currently is and not attempt to edit the library utilised to include the filters. Should the business operate 24 hours a day and require the functionality to pull the previous days orders during that one hour window it would obviously need to be resolved.